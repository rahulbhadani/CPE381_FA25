\pgfdeclareverticalshading[lower.bg,upper.bg]{bmb@transition}{200cm}{%
  color(0pt)=(lower.bg); color(2pt)=(lower.bg); color(4pt)=(lower.bg)}

\setbeamersize{text margin left=1em,text margin right=1em} 

\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}{\leavevmode\leftskip=3.2em\rlap{\hskip-2em\inserttocsectionnumber.\inserttocsubsectionnumber}\inserttocsubsection\par}


\usepackage{fontawesome5}


\pgfdeclareimage[width=0.09\paperwidth]{logo}{figures/uah.png}
\pgfdeclareimage[width=0.09\paperwidth]{whitelogo}{figures/uah.png}
\newcommand{\@logo}{logo}

\setbeamercolor{title}{bg=white}
\setbeamercolor{alerted text}{fg=maincolor}
\setbeamercolor{author}{fg=pineGreen}
\setbeamercolor{date}{fg=black}

\setbeamerfont{author}{size=\small}
\setbeamerfont{date}{size=\small}
\setbeamerfont{title}{series=\bfseries}
\setbeamerfont{subtitle}{series=\mdseries,size=\small}
\setbeamerfont{frametitle}{series=\bfseries}
\setbeamerfont{framesubtitle}{series=\mdseries}
\setbeamerfont{footline}{size=\scriptsize}
\setbeamerfont{block title}{series=\centering\bfseries}

% Code to get prettier boxes
\setbeamertemplate{blocks}[rounded]

% Bullets in several levels
\setbeamertemplate{itemize item}{\textbullet}
\setbeamertemplate{itemize subitem}{\textemdash}
\setbeamertemplate{itemize subsubitem}{\ensuremath{\circ}}

\newenvironment{colorblock}[3][white]{%
	\begingroup
	\setbeamercolor{block title}{fg=#1,bg=#2}
	\setbeamercolor{block body} {fg=#1,bg=#2}
	\begin{block}{#3}
	}{%
	\end{block}
	\endgroup
}

\def\@courseLabel{}
\def\@IDnumber{}


% Define the title page
\setbeamertemplate{title page}{%
  \vskip0pt plus 1filll%
  % Reposition the box in an inelegant way - but it works!
  \hspace{-12mm}
  \vspace{20mm}
  \begin{beamercolorbox}[wd=0.72\textwidth,sep=10pt,leftskip=8mm]{title}%
    {\usebeamerfont{title}\inserttitle}
  
    {\usebeamerfont{subtitle}\insertsubtitle}

    {\usebeamerfont{subtitle}\@courseLabel}
    
    {Fall 2025}
    
    {\usebeamerfont{author}\usebeamercolor[fg]{author}\textbf{\insertauthor} \ifdefempty{\@IDnumber}{}{(\@IDnumber)}}
  
    {\usebeamerfont{date}\usebeamercolor[fg]{date}\insertdate}
  \end{beamercolorbox}
}

% Define slide splitting dimensions (e.g. title and chapter slides)
\newcommand{\TikzSplitSlide}[1]{%
  \rule{0.56\paperwidth}{0pt}%
  \begin{tikzpicture}
    \clip (-0.1\paperwidth,-0.5\paperheight) -- 
          ( 0.5\paperwidth,-0.5\paperheight) -- 
          ( 0.5\paperwidth, 0.5\paperheight) -- 
          ( 0.1\paperwidth, 0.5\paperheight) -- cycle; 
    \node at (0.2\paperwidth,0) {%
      \includegraphics[height=\paperheight]{#1}%
    };
  \end{tikzpicture}
}

\newbool{splittitle}
\newcommand{\@TitleBackground}{}
\newcommand{\titlebackground}{\@ifstar{\SplitBackground}{\FullBackground}}
\newcommand{\FullBackground}[1]{\renewcommand{\@TitleBackground}{#1}}
\newcommand{\SplitBackground}[1]{%
	\booltrue{splittitle}%
	\renewcommand{\@TitleBackground}{#1}%
}

% Overwrite the maketitle command for the title page
\renewcommand{\maketitle}{
\begingroup
  \ifdefempty{\@TitleBackground}{}{% Skip if \@TitleBackground is empty
    \setbeamertemplate{background}{%
      \ifbool{splittitle}{%
        \TikzSplitSlide{\@TitleBackground}
      }{% Normal, full-screen background
        \includegraphics[height=\paperheight]{\@TitleBackground}
      }
    }
  }
  \begin{frame}%
  \titlepage%
  \end{frame}%
\endgroup
}

\makeatletter
    \newenvironment{withoutheadline}{
        \setbeamertemplate{headline}[default]
        \def\beamer@entrycode{\vspace*{-\headheight}}
    }{}
\makeatother

% Define chapter environment
\newenvironment{chapter}[3][]{% Args: image (optional), color, frame title
  \begingroup
  \themecolor{main}
  \setbeamertemplate{footline}{}
  \ifstrempty{#2}{
    \setbeamercolor{frametitle}{fg=white}
    \setbeamercolor{normal text}{fg=white,bg=maincolor}
  }{
    \setbeamercolor{frametitle}{fg=white}
    \setbeamercolor{normal text}{fg=white,bg=#2}
  }
  \ifstrempty{#1}{}{\setbeamertemplate{background}{\TikzSplitSlide{#1}}}
  \setbeamertemplate{frametitle}{%
    \vspace*{8ex}
    \begin{beamercolorbox}[wd=0.45\textwidth]{frametitle}
      \usebeamerfont{frametitle}\insertframetitle\\
      \usebeamerfont{framesubtitle}\insertframesubtitle
    \end{beamercolorbox}
  }
  \begin{frame}{#3}
  \hspace*{0.05\textwidth}%
  \minipage{0.35\textwidth}%
  \usebeamercolor[fg]{normal text}%
}{%
  \endminipage
  \end{frame}
  \endgroup
}

% Define sidepic environment
\newenvironment{sidepic}[2]{% Args: image, frame title
  \begingroup
  \setbeamertemplate{background}{%
  \hspace*{0.6\paperwidth}%
  \includegraphics[height=\paperheight]{#1}%
  }
  \setbeamertemplate{frametitle}{% Same as normal, but with right skip
    \vspace*{-3.5ex}
    \begin{beamercolorbox}[leftskip=2cm,rightskip=0.4\textwidth]{frametitle}%
      \usebeamerfont{frametitle}\insertframetitle\\
      \usebeamerfont{framesubtitle}\insertframesubtitle
    \end{beamercolorbox}
  }
  \begin{frame}{#2}
  \minipage{0.6\textwidth}%
}{%
  \endminipage
  \end{frame}
  \endgroup
}

% Define backmatter
\newcommand{\backmatter}[1][]{
\begingroup
  \themecolor{main}
  \begin{frame}[c]
    \centering
    \begin{minipage}{\textwidth}
      \usebeamercolor[fg]{normal text}
      \centering
      \ifstrequal{#1}{notitle}{}{
        \Huge \inserttitle
        \vspace{5mm}
      }
      \Large \textsl{\\Thank you for listening! \\ Any questions?}
    \end{minipage}
  \end{frame}
\endgroup
}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{sectionframe}[2]{
\section{#2}
    \begin{frame} % Begin the frame
    \begin{tikzpicture}[remember picture, overlay]
        \node[anchor=south east, xshift=-30pt, yshift=55pt] at (current page.south east) {          
            	 \tcbset{
            sharp corners,
            colback=white,
            colframe=white,
            halign=center, % Align content within the box
            boxrule=0pt, % Thickness of the border
            left=0.01em, % Padding on the left
            right=0.01em, % Padding on the right
            top=0.01em, % Padding on the top
            bottom=0.01em, % Padding on the bottom
            ,center title}
               \begin{tcolorbox}[width=0.80\linewidth]{\color{white}{\Huge \bfseries \color{DarkBlue}   #1 \hspace{3pt}   #2  }}
    \end{tcolorbox}
            
        };
           \node[anchor=south east, xshift=-27pt, yshift=42pt, rectangle, fill=softLilac, 
              minimum width=300pt, minimum height=1em] 
             at (current page.south east) {};
        \node[anchor=south east, xshift=-30pt, yshift=45pt, rectangle, fill=roseRed, 
              minimum width=300pt, minimum height=1em] 
             at (current page.south east) {};
        \node[anchor=south east, xshift=-29pt, yshift=47pt, rectangle, fill=white, 
              minimum width=302pt, minimum height=1em] 
             at (current page.south east) {};
           
    \end{tikzpicture}
}{\end{frame}}


\newenvironment{subsectionframe}[1]{
\subsection{#1}
    \begin{frame} % Begin the frame
    \begin{tikzpicture}[remember picture, overlay]
        \node[anchor=south east, xshift=-0.35\linewidth, yshift=0.7\paperheight] at (current page.south east) {
                \tcbset{enhanced,
            sharp corners,
            colback=white,
            colframe=white,
            halign=center, % Align content within the box
            boxrule=2pt, % Thickness of the border
            left=0.1em, % Padding on the left
            right=0.1em, % Padding on the right
            top=0.1em, % Padding on the top
            bottom=0.1em, % Padding on the bottom
            drop lifted shadow=pineGreen,center title}
               \begin{tcolorbox}[width=0.60\linewidth]{\color{white}{ \Large\bfseries \color{rosewood}  #1  }}
    \end{tcolorbox}
        };
    \end{tikzpicture}
}{\end{frame}}


\hypersetup{
    citecolor=pineGreen,        % color of links to bibliography
    urlcolor=rosewood           % color of external links
}

\newtcolorbox{tblock}[2][]{
  enhanced,
  breakable,
  sharp corners=northwest,
  sharp corners=southeast,
  colback=white,
  colframe=red!75!black,
  halign=left, 
  boxrule=1pt, 
  left=1em, 
  right=1em, 
  top=0.5em, 
  bottom=0.5em, 
  drop shadow=coolGray,
  title=#2,
  #1
}

\newtcolorbox{talert}[2][]{%
	enhanced,
    colbacktitle=cherryRed!20!white, 
    coltitle=black, 
    colback=white,
    title=#2,
    boxrule=0pt,
    drop shadow, % Add a drop shadow
    sharp corners,
    #1
}

\newtcolorbox{facts}[2][]{beamer,title=#2,left=1mm,right=1mm,top=1mm,bottom=1mm,arc=0mm,
  colback=InvisibleRed,colupper=black,colframe=InvisibleRed,fonttitle=\sffamily,
  coltitle=black,title style={left color=GreenYellow!70,right color=BlueGreen},
  #1}

  \newtcolorbox{gradblock}[2][]{beamer,title=#2,left=1mm,right=1mm,top=1mm,bottom=1mm,arc=0mm,
  colback=Seashell,colupper=black,colframe=Seashell,fonttitle=\sffamily,
  coltitle=black,title style={left color=Goldenrod!70,right color=Tomato},
  #1}


% Add these to your preamble

% \usepackage{patterns}
\usetikzlibrary{patterns,shapes}

% 1. Bubblegum Blush
\newtcolorbox{bubblegum}[2][]{
  enhanced, breakable, rounded corners,
  colback=pink!5, colframe=pink!70!red,
  coltitle=MediumBlue!95!red, fonttitle=\bfseries\scshape,
  title={~#2}, drop shadow={pink!50},
  #1}

% 2. Minty Meadow
\newtcolorbox{minty}[2][]{
  enhanced, breakable, sharp corners,
  colback=cpelime!2, colframe=green!60!black,
  coltitle=green!50!black, title style={left color=cpegreen,right color=white},
  title={\faLeaf~~#2}, boxrule=2pt, arc=3mm,
  underlay={\pattern[pattern=checkerboard,pattern color=cpegreen!5] (frame.south west) rectangle (frame.north east);},
  #1}

% 3. Sunny Sparkle
% \newtcolorbox{sunny}[2][]{
%   enhanced, breakable, oval,
%   colback=yellow!10, colframe=yellow!70!orange,
%   title={\faSun~~#2}, halign=center,
%   drop shadow={yellow!50}, borderline={1pt}{0pt}{yellow!50},
%   overlay={\foreach \i in {1,...,5} \node[star,fill=yellow!30] at (frame.south east) {};},
%   #1}

% 4. Ocean Whisper
\newtcolorbox{ocean}[2][]{
  enhanced, breakable, colback=cyan!5,
  frame style={left color=blue!60,right color=teal!60},
  coltitle=white, title={#2},
  borderline west={1pt}{0pt}{blue!50}, 
  borderline east={1pt}{0pt}{teal!50},
  fuzzy shadow={0pt}{-2pt}{0pt}{0.4pt}{blue!20!teal},
  #1}

% 5. Twilight Glow
\newtcolorbox{twilight}[2][]{
  enhanced, breakable, 
  colback=purple!5, colframe=purple!60!blue,
  title={#2}, coltitle=purple!80!pink,
  frame hidden, borderline={0.5pt}{0pt}{purple!30},
  fuzzy shadow={0pt}{-2pt}{0pt}{0.4pt}{purple!20},
  overlay={\node[rotate=30,purple!30] at (frame.center) {\faMagic};},
  #1}

% 6. Cotton Cloud
\newtcolorbox{cotton}[2][]{
  enhanced, breakable, rounded corners,
  colback=white, colframe=gray!30,
  title={\faCloud~~#2}, coltitle=gray!60,
  boxrule=0.8pt, drop shadow={gray!40},
  overlay first={\draw[gray!20,line width=2pt] (frame.north west) -- (frame.south east);},
  #1}

% 7. Berry Burst
\newtcolorbox{berry}[2][]{
  enhanced, breakable, 
  colback=red!5, colframe=red!10!pink,
  title={#2}, coltitle=red!10!black,
  arc=3mm, watermark color=red!10,
  watermark text={\Large\faPaperclip},
  underlay={\draw[red!30,double] (frame.south west) to[out=15,in=150] (frame.south east);},
  #1}

% 8. Golden Hour
\newtcolorbox{golden}[2][]{
  enhanced, breakable, 
  colback=orange!5, colframe=orange!70!yellow,
  title={\faStar~~#2}, coltitle=orange!90!red,
  frame style={top color=orange!60,bottom color=orange!40},
  borderline={1pt}{0pt}{orange!30},
  drop shadow={orange!50},
  overlay={\node[orange!30] at (frame.center) {\faSunO};},
  #1}

% 9. Fairy Frost
\newtcolorbox{fairy}[2][]{
  enhanced, breakable, 
  colback=white, colframe=cyan!50!blue,
  title={#2}, coltitle=cyan!70,
  boxrule=1.5pt, arc=3mm,
  borderline={0.5pt}{0pt}{cyan!20},
  fuzzy shadow={0pt}{-2pt}{0pt}{0.4pt}{cyan!30},
  overlay={\foreach \i in {1,...,3} \node[cyan!30] at (frame.south east) {\faAsterisk};},
  #1}

% 10. Peach Fizz
\newtcolorbox{peach}[2][]{
  enhanced, breakable,
  rounded corners,
  sharp corners=northwest,
  sharp corners=southeast,
  colback=peachFuzz!10, colframe=peachFuzz!70!orange,
  title={#2}, coltitle=red!90!orange,
  boxrule=1.2pt,
  drop shadow={burgundy!90}
  #1}

  \newtcolorbox{CloudNineBox}[2][]{
    enhanced,
    breakable,
    rounded corners=all,
    colback=gray!10,
    colframe=gray!50!white,
    halign=left, 
    boxrule=1pt, 
    left=1em, 
    right=1em, 
    top=0.5em, 
    bottom=0.5em, 
    drop shadow={gray!20},
    title=#2,
    #1
  }

  \newtcolorbox{origami}[2][]{
  enhanced, sharp corners, 
  colback=yellow!10, colframe=orange!60,
  title style={fill=orange!20, rounded corners=3pt},
  title={\faPaperPlane~~#2}, 
  underlay={
    \fill[orange!40, rotate around={45:(frame.north east)}] 
      (frame.north east) rectangle ++(-0.5cm,-0.5cm);
    \draw[orange!70, line width=0.8pt] 
      (frame.north east) -- ++(-0.35cm,-0.35cm);},
  borderline={1pt}{0pt}{orange!30},
  #1}

  \newtcolorbox{tblockFrost}[2][]{
    enhanced,
    breakable,
    arc=2mm,
    colback=cyan!5,
    colframe=cyan!80!blue,
    boxrule=1pt,
    left=1em,
    right=1em,
    top=0.5em,
    bottom=0.5em,
    drop shadow={xshift=1mm, yshift=-1mm, opacity=0.3},
    title=#2,
    #1
  }

  \newtcolorbox{tblockWing}[2][]{%
  enhanced,
  breakable,
  colback=white,
  colframe=teal!80!black,
  boxrule=1pt,
  left=1em,
  right=1em,
  top=2em,
  bottom=1em,
  title=#2,
  #1
}

  \newtcolorbox{gradbox}[2][]{beamer,title=#2,left=1mm,right=1mm,top=1mm,bottom=1mm,arc=1mm,
  colback=MistyRose,colupper=black,colframe=Tomato,fonttitle=\sffamily,
  coltitle=black,title style={left color=Goldenrod!70,right color=Tomato},
  #1}


\newcommand{\faFlash}{\faIcon{bolt}}

\newcommand{\tikzLightning}{%
  \begin{tikzpicture}[scale=0.15, baseline=-0.5ex]
    \draw[fill=black, line width=0.5pt] 
      (0,0) -- (1,2) -- (0.5,1) -- (1.5,0) -- (0.5,-1) -- (1,-2) -- (0,-1) -- cycle;
  \end{tikzpicture}%
}

\setbeamertemplate{itemize item}{\faFlash}

\newcommand{\intinf}{\int_{-\infty}^\infty}

\newcommand{\suminf}[1]{\sum_{#1=-\infty}^\infty}

\newenvironment{multiequation}{%
  \setlength{\abovedisplayskip}{3pt}      % Reduce space above the equation
  \setlength{\belowdisplayskip}{3pt}      % Reduce space below the equation
  \setlength{\abovedisplayshortskip}{0pt} % Reduce space above short equations
  \setlength{\belowdisplayshortskip}{0pt} % Reduce space below short equations
  \begin{equation*}%                      % Start an unnumbered equation
    \begin{aligned}%                       % Align multiple lines
}{%
    \end{aligned}%                        % End alignment
  \end{equation*}%                        % End equation
}

\setlength{\parskip}{0pt}
\setlength{\abovedisplayskip}{0pt} % Reduce space above the equation
\setlength{\belowdisplayskip}{0pt} % Reduce space below the equation
\setlength{\abovedisplayshortskip}{0pt} % Space above short equations
\setlength{\belowdisplayshortskip}{0pt} % Space below short equations